<odoo>
    <record id="view_product_tree_inherit_stock_history_location_group" model="ir.ui.view">
        <field name="name">product.product.tree.inherit.stock.history.location.group</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="stock.view_stock_product_tree"/>
        <field name="arch" type="xml">
            <!-- Añadir el campo `location_ids` al final de la vista -->
            <xpath expr="//tree" position="inside">
                <field name="location_ids" widget="many2many_tags" string="Locations"/>
            </xpath>
        </field>
    </record>

    <record id="view_stock_quant_tree_inherit" model="ir.ui.view">
        <field name="name">stock.quant.tree.inherit</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.view_stock_quant_tree"/>
        <field name="arch" type="xml">
            <!-- Añadir un atributo de agrupación explícita -->
            <xpath expr="//tree" position="attributes">
                <attribute name="decoration-bf">group_by(location_id)</attribute>
            </xpath>
            <!-- Podemos ajustar la secuencia de los campos -->
            <xpath expr="//field[@name='product_id']" position="after">
                <field name="location_id" string="Location"/>
            </xpath>
        </field>
    </record>


</odoo>
